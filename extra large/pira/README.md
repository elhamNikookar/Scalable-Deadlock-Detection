# شبیه‌سازی رویکرد TPMC آقای پیرا برای مسئله فیلسوفان غذا

این پروژه شامل پیاده‌سازی و شبیه‌سازی رویکرد TPMC (Two-Phase Model Checking) آقای پیرا برای مسئله فیلسوفان غذا با 100 فیلسوف است.

## 📋 فهرست مطالب

- [معرفی](#معرفی)
- [رویکرد TPMC](#رویکرد-tpmc)
- [فایل‌های پروژه](#فایل‌های-پروژه)
- [نصب و راه‌اندازی](#نصب-و-راه‌اندازی)
- [استفاده](#استفاده)
- [نتایج](#نتایج)
- [ویژگی‌ها](#ویژگی‌ها)

## 🔍 معرفی

مسئله فیلسوفان غذا یکی از مسائل کلاسیک در علوم کامپیوتر است که برای درک مفاهیم همزمانی و deadlock استفاده می‌شود. در این مسئله، چندین فیلسوف دور یک میز نشسته‌اند و هر کدام دو چنگال (یکی در سمت چپ و یکی در سمت راست) نیاز دارند تا غذا بخورند.

### مسئله اصلی:
- هر فیلسوف یا در حال تفکر است یا گرسنه است یا در حال خوردن
- برای خوردن، هر فیلسوف به دو چنگال نیاز دارد
- چنگال‌ها مشترک هستند (هر چنگال بین دو فیلسوف مشترک است)
- اگر همه فیلسوفان همزمان چنگال چپ خود را بردارند، deadlock رخ می‌دهد

## 🔬 رویکرد TPMC

TPMC (Two-Phase Model Checking) رویکردی است که توسط آقای پیرا و همکارانش ارائه شده و شامل دو فاز اصلی است:

### فاز اول: Graph Transformation Systems (GTS)
- مدل‌سازی سیستم به صورت گراف
- تعریف قوانین تبدیل برای تغییر حالت‌ها
- ایجاد فضای حالت سیستم

### فاز دوم: Bayesian Optimization
- استفاده از الگوریتم‌های بهینه‌سازی بیزی
- جستجوی هوشمند در فضای حالت
- تشخیص deadlock با دقت بالا

### ویژگی‌های کلیدی TPMC:
- **100 تکرار** برای الگوریتم
- **محدودیت‌های اکتشاف** متناسب با اندازه مسئله
- **تشخیص پیشرفته deadlock** با تحلیل چرخه‌ها و زنجیره‌های انتظار
- **بهینه‌سازی بیزی** برای انتخاب بهترین عمل

## 📁 فایل‌های پروژه

### 1. `tpmc_dining_philosophers.py`
نسخه پایه شبیه‌ساز TPMC شامل:
- پیاده‌سازی مسئله فیلسوفان غذا
- الگوریتم TPMC ساده
- تشخیص deadlock با تحلیل چرخه‌های قوی متصل
- نمایش بصری نتایج

### 2. `tpmc_advanced_simulation.py`
نسخه پیشرفته شبیه‌ساز TPMC شامل:
- تشخیص پیشرفته deadlock (چرخه‌ها، زنجیره‌های انتظار، رقابت منابع)
- شبیه‌سازی دقیق‌تر رفتار فیلسوفان
- تحلیل عمیق‌تر ویژگی‌های گراف
- آمارگیری پیشرفته و معیارهای عملکرد
- صادر کردن نتایج به فرمت JSON

### 3. `main.tex`, `main2.tex`, `main_2.tex`
فایل‌های LaTeX حاوی مقالات و تحقیقات مربوط به TPMC و روش‌های تشخیص deadlock

## 🚀 نصب و راه‌اندازی

### پیش‌نیازها:
```bash
pip install numpy networkx matplotlib
```

### اجرای کد:
```bash
# نسخه پایه
python tpmc_dining_philosophers.py

# نسخه پیشرفته
python tpmc_advanced_simulation.py
```

## 💻 استفاده

### نسخه پایه:
```python
from tpmc_dining_philosophers import TPMCSimulator

# ایجاد شبیه‌ساز برای 100 فیلسوف
simulator = TPMCSimulator(num_philosophers=100)

# اجرای شبیه‌سازی
results = simulator.run_tpmc_simulation()

# نمایش نتایج
simulator.visualize_system_state("results.png")
simulator.export_results("results.txt")
```

### نسخه پیشرفته:
```python
from tpmc_advanced_simulation import AdvancedTPMCSimulator

# ایجاد شبیه‌ساز پیشرفته
simulator = AdvancedTPMCSimulator(
    num_philosophers=100,
    deadlock_probability=0.4
)

# اجرای شبیه‌سازی
results = simulator.run_advanced_tpmc_simulation()

# نمایش نتایج پیشرفته
simulator.visualize_advanced_system("advanced_results.png")
simulator.export_advanced_results("advanced_results.json")
```

## 📊 نتایج

### نتایج نسخه پایه:
- **زمان اجرا**: ~0.07 ثانیه
- **تعداد تکرارها**: 100
- **حالت‌های اکتشاف شده**: 100
- **Deadlock‌های یافت شده**: 0 (در اجرای عادی)

### نتایج نسخه پیشرفته:
- **زمان اجرا**: ~0.40 ثانیه
- **تعداد تکرارها**: 100
- **حالت‌های اکتشاف شده**: 100
- **Deadlock‌های یافت شده**: 36 (با احتمال deadlock 0.4)
- **نمره پایداری**: 0.074
- **میانگین رقابت منابع**: 0.000

## ✨ ویژگی‌ها

### ویژگی‌های نسخه پایه:
- ✅ پیاده‌سازی مسئله فیلسوفان غذا
- ✅ الگوریتم TPMC با 100 تکرار
- ✅ تشخیص deadlock با تحلیل چرخه‌ها
- ✅ نمایش بصری سیستم
- ✅ صادر کردن نتایج به فایل متنی

### ویژگی‌های نسخه پیشرفته:
- ✅ تشخیص پیشرفته deadlock (چرخه‌ها، زنجیره‌های انتظار، رقابت منابع)
- ✅ شبیه‌سازی دقیق‌تر با حالت‌های اضافی (انتظار)
- ✅ تحلیل عمیق‌تر ویژگی‌های گراف
- ✅ آمارگیری پیشرفته و معیارهای عملکرد
- ✅ صادر کردن نتایج به فرمت JSON
- ✅ نمودارهای تکامل سیستم
- ✅ محاسبه نمره پایداری

## 🔧 تنظیمات

### پارامترهای قابل تنظیم:

#### نسخه پایه:
- `num_philosophers`: تعداد فیلسوفان (پیش‌فرض: 100)
- `max_iterations`: حداکثر تعداد تکرارها (پیش‌فرض: 100)

#### نسخه پیشرفته:
- `num_philosophers`: تعداد فیلسوفان (پیش‌فرض: 100)
- `deadlock_probability`: احتمال deadlock (پیش‌فرض: 0.4)
- `max_iterations`: حداکثر تعداد تکرارها (پیش‌فرض: 100)

## 📈 تحلیل نتایج

### معیارهای عملکرد:
1. **نمره پایداری**: هرچه بالاتر باشد، سیستم پایدارتر است
2. **رقابت منابع**: هرچه کمتر باشد، رقابت کمتری وجود دارد
3. **تراکم گراف**: نشان‌دهنده پیچیدگی روابط در سیستم
4. **تعداد deadlock‌ها**: نشان‌دهنده کارایی الگوریتم تشخیص

### انواع deadlock تشخیص داده شده:
1. **Circular Wait**: چرخه‌های انتظار دایره‌ای
2. **Waiting Chain**: زنجیره‌های انتظار خطی
3. **Resource Contention**: رقابت شدید بر سر منابع
4. **Mixed**: ترکیبی از انواع بالا

## 🎯 کاربردها

این شبیه‌ساز می‌تواند برای:
- آموزش مفاهیم همزمانی و deadlock
- تست الگوریتم‌های تشخیص deadlock
- تحقیق در زمینه سیستم‌های توزیع شده
- تحلیل رفتار سیستم‌های پیچیده
- توسعه روش‌های جدید تشخیص deadlock

## 📚 مراجع

1. Pira et al. (2017): "GTS+BOA approach for deadlock detection"
2. Pira et al. (2022): "Two-phase model checking framework"
3. Pira et al. (2016): "GTS+DataMining for efficient model checking"
4. Pira et al. (2022): "GTS+Neural Networks for AI planning"

## 🤝 مشارکت

برای مشارکت در این پروژه:
1. Fork کنید
2. شاخه جدید ایجاد کنید
3. تغییرات خود را commit کنید
4. Pull request ارسال کنید

## 📄 مجوز

این پروژه تحت مجوز MIT منتشر شده است.

## 👥 نویسندگان

- **تحلیل مقالات**: بر اساس تحقیقات آقای پیرا و همکاران
- **پیاده‌سازی**: شبیه‌ساز TPMC برای مسئله فیلسوفان غذا
- **توسعه**: نسخه‌های پایه و پیشرفته

---

**نکته**: این شبیه‌ساز برای اهداف آموزشی و تحقیقاتی طراحی شده است و ممکن است نیاز به تنظیمات بیشتری برای استفاده در محیط‌های تولیدی داشته باشد.
